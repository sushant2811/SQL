/*
SQLZOO Helpdesk Answers
Questions available at http://sqlzoo.net/wiki/Help_Desk
*/

/*
#1. There are three issues that include the words "index" and "Oracle". Find the call_date for each of them
*/

SELECT call_date, call_ref 
FROM Issue 
WHERE detail LIKE  '%index%' 
AND detail LIKE '%Oracle%' ;

/*
#2. Samantha Hall made three calls on 2017-08-14. Show the date and time for each
*/

SELECT call_date, first_name, last_name
FROM Caller
JOIN Issue
using (Caller_id)
WHERE First_name = 'Samantha' AND Last_name='Hall' AND date(call_date) = '2017-08-14'

/*
3.
There are 500 calls in the system (roughly). Write a query that shows the number that have each status.
*/

SELECT Status,
count(*) AS Volume
FROM Issue
GROUP BY 1

/*
 4.
Calls are not normally assigned to a manager but it does happen. How many calls have been assigned to staff who are at Manager Level?
*/

SELECT COUNT(*) AS mlcc
FROM Issue AS i
JOIN Staff AS s
ON i.assigned_to = s.Staff_code
JOIN Level AS l
USING (Level_code)
WHERE Manager = 'Y'

/*
5. Show the manager for each shift. Your output should include the shift date and type; also the first and last name of the manager.
*/

SELECT Shift_date, shift_type, first_name, last_name 
FROM Shift
JOIN Staff
ON (Shift.Manager = Staff.staff_code)
ORDER BY 1
